nextflow_workflow {

    name "Test Workflow PARSE_PAIRWISE_INPUT"
    script "subworkflows/local/parse_pairwise_input/main.nf"
    config "tests/subworkflows/local/parse_pairwise_input/.testconfig"
    profile "singularity"
    workflow "PARSE_PAIRWISE_INPUT"

    test("Should run without failures") {

        when {
            params {
                // define parameters here. Example:
                outdir = "${projectDir}/tests/subworkflows/local/parse_pairwise_input/output"
            }
            workflow {
                """
                // define inputs of the workflow here. Example:
                input[0] = file("${projectDir}/tests/ARTR-seq/input_data/pairwise_peak_calling_for_testing.csv")
                """
            }
        }

        then {
            assert workflow.success
            assert snapshot(workflow.out).match()

            // asseert the pairwise channel contains [WT_BRD4_plus_R1,WT_No_Ab_R1]
            with(workflow.out.pairwise) {
                assert size() == 2
                assert contains(['WT_BRD4_plus_R1', 'WT_No_Ab_R1'])
            }
        }

    }

}
